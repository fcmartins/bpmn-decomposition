{-
 - TyCO assembly
 - Generated by TyCOa on Mon May 12 16:18:59 WEST 2003
 -}

registers 6

code main_code#0 {
  	-- Try Reduce Object at channel io
  r4 := r1 [0]
  r4.lock()
  r5 := r4.getStatus ()
  if r5 >= 0 jump enqueue#20
  r5 := r4.dequeue ()
  r6 := r5 [1]	-- Get offset of the method
  r6 := io_table#11 [r6]
  r5 [1] := r6	-- Fill address of thread code
  r5 [2] := r3	-- Fill closure
  launch r5
  jump done#21
  enqueue#20:
  	-- Thread frame at r5
  r5 := malloc 4
  r5 [1] := io_table#11	-- Fill code
  r5 [2] := r3	-- Fill closure
  	-- End of thread frame
  r4.enqueueObj (r5)
  done#21:
  r4.unlock()
  	-- End of Try Reduce Object at channel io
  schedule
}

data io_table#11 {	-- length 9
  io_getb_code#1
  io_geti_code#3
  io_gets_code#4
  io_printb_code#5
  io_printi_code#6
  io_prints_code#7
  io_putb_code#8
  io_puti_code#9
  io_puts_code#10
}

data r_table#12 {	-- length 10
  -1
  -1
  -1
  -1
  -1
  -1
  -1
  -1
  -1
  r_val_code#2
}

code r_val_code#2 {
  r1 := r0 [3]	-- 1 parameters
  schedule
}

code io_getb_code#1 {
  r1 := r0 [3]	-- 1 parameters
  	-- Try Reduce Object at channel r
  r4 := r1 [0]
  r4.lock()
  r5 := r4.getStatus ()
  if r5 >= 0 jump enqueue#13
  r5 := r4.dequeue ()
  r6 := r5 [1]	-- Get offset of the method
  r6 := r_table#12 [r6]
  r5 [1] := r6	-- Fill address of thread code
  r5 [2] := r3	-- Fill closure
  launch r5
  jump done#14
  enqueue#13:
  	-- Thread frame at r5
  r5 := malloc 4
  r5 [1] := r_table#12	-- Fill code
  r5 [2] := r3	-- Fill closure
  	-- End of thread frame
  r4.enqueueObj (r5)
  done#14:
  r4.unlock()
  	-- End of Try Reduce Object at channel r
  schedule
}

code io_geti_code#3 {
  r1 := r0 [3]	-- 1 parameters
  	-- Arguments frame at r3
  r3 := malloc 1
  r5 := 0
  r6 := 321
  r4 := r5 - r6
  r3 [0] := r4
  	-- End of arguments
  	-- Try Reduce Message at channel r offset 9
  r4 := r1 [0]
  r4.lock()
  r6 := r4.getStatus ()
  if r6 <= 0 jump enqueue#15
  r6 := r4.dequeue ()
  r5 := r6 [1]	-- Address of method table
  r5 := r5 [9]
  r6 [1] := r5	-- Address of thread code
  launch r6
  jump done#16
  enqueue#15:
  	-- Thread frame at r6
  r6 := malloc 4
  r6 [1] := 9	-- Fill code
  	-- End of thread frame
  r4.enqueueMsg (r6)
  done#16:
  r4.unlock()
  	-- End of Try Reduce Message at channel r
  schedule
}

string string#17 "hi there"

code io_gets_code#4 {
  r1 := r0 [3]	-- 1 parameters
  	-- Arguments frame at r3
  r3 := malloc 1
  r4 := string#17
  r3 [0] := r4
  	-- End of arguments
  	-- Try Reduce Message at channel r offset 9
  r4 := r1 [0]
  r4.lock()
  r5 := r4.getStatus ()
  if r5 <= 0 jump enqueue#18
  r5 := r4.dequeue ()
  r6 := r5 [1]	-- Address of method table
  r6 := r6 [9]
  r5 [1] := r6	-- Address of thread code
  launch r5
  jump done#19
  enqueue#18:
  	-- Thread frame at r5
  r5 := malloc 4
  r5 [1] := 9	-- Fill code
  	-- End of thread frame
  r4.enqueueMsg (r5)
  done#19:
  r4.unlock()
  	-- End of Try Reduce Message at channel r
  schedule
}

code io_printb_code#5 {
  r1 := r0 [3]	-- 1 parameters
  schedule
}

code io_printi_code#6 {
  r1 := r0 [3]	-- 1 parameters
  schedule
}

code io_prints_code#7 {
  r1 := r0 [3]	-- 1 parameters
  schedule
}

code io_putb_code#8 {
  r1 := r0 [3]	-- 2 parameters
  schedule
}

code io_puti_code#9 {
  r1 := r0 [3]	-- 2 parameters
  schedule
}

code io_puts_code#10 {
  r1 := r0 [3]	-- 2 parameters
  schedule
}

